<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Pagina Grafico</title>
  <link rel="stylesheet" href="estilo.css">
  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link
    href="https://fonts.googleapis.com/css2?family=Poppins:ital,wght@0,200;0,400;0,600;0,800;1,300;1,500;1,600&display=swap"
    rel="stylesheet" />
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <script src="http://www.chartjs.org/dist/2.7.1/Chart.js"></script>
  <script src="http://www.chartjs.org/samples/latest/utils.js"></script>
</head>

<body>
  <div id="principal_pagina_grafico">
    <div class="cabecario">
      <div id="div_logo">
        <h2 id="texto_cowtech"><a href="index.html">COW TECH</a></h2>

      </div>
      <div id="div_links">
        <ul id="lista_cabecario">
          <a href="sistema.html">SISTEMA</a>
          <a href="#div_grafico">GRÁFICOS</a>
          <a href="login.html">SAIR</a>
        </ul>
      </div>
    </div>
    <div id="div_graficos">
      <div id="div_select" style="position: relative;">
        <h4 id="select_fazenda_h4" style="color: black; position: absolute; margin-top: -12%;">Curral</h4>
        <select name="" id="select_fazenda" class="select_grafico"></select>
        <h4 id="select_galpao" style="color: black; position: absolute;margin-top: -12%;">Fazenda</h4>
        <select name="" id="listaCurrais" class="select_grafico"></select>
        <button id="button_pesquisar" onclick="Pesquisar()"><img src="lupa.png" alt=""></button>
      </div>
      <div id="div_titulo_grafico">

      </div>
      <div id="div_todos_graficos">
        <div id="div_separacao_grafico">
          <div class="graficos1" style="margin-right: 2%;" id="graf1">

            <section style="width: 100%; align-items: center; justify-content: center;" id="myChartCanvas">
              <canvas id="lm35Temperatura" style="width: 82%; height: 80%; margin-top: 0%;"></canvas>
            </section>

          </div>
          <div class="graficos1">

            <section style="width: 100%;align-items: center; justify-content: center;" id="myChartCanvas">
              <canvas id="dht11Umidade" style="width: 82%; height: 80%; margin-top: 0%;"></canvas>
            </section>

          </div>
        </div>
        <div id="div_separacao_grafico">
          <div class="graficos1" style="margin-right: 2%;">

            <section style="width: 100%;align-items: center; justify-content: center;" id="myChartCanvas">
              <canvas id="lm35Temperatura2" style="width: 95%; height: 90%; margin-top: 0%;"></canvas>
            </section>

          </div>
          <div class="graficos1">
            <section style="width: 100%;align-items: center; justify-content: center;" id="myChartCanvas">
              <canvas id="dht11Umidade2" style="width: 82%; height: 80%; margin-top: 0%;"></canvas></canvas>
            </section>

          </div>
        </div>
      </div>
    </div>
  </div>

</body>
<script defer>
  var idEmpresa = sessionStorage.ID_EMPRESA
  texto_cowtech.innerHTML = sessionStorage.ID_EMPRESA;
  var Sensores = sessionStorage.SENSOR
  var fkSensor = sessionStorage.SENSOR
  console.log(Sensores)
  console.log(fkSensor);


  fetch(`/currais/listar/`, {
    method: "GET",
  })
    .then(function (resposta) {
      resposta.json().then((currais) => {
        currais.forEach((curral) => {
          listaCurrais.innerHTML += `<option value='${curral.idCurral}'>${curral.nomeCurral}</option>`;
        });
      });
    })
    .catch(function (resposta) {
      console.log(`#ERRO: ${resposta}`);
    });

  fetch(`/enderecos/listar/${idEmpresa}`, {
    method: "GET",
  })
    .then(function (resposta) {
      resposta.json().then((enderecos) => {
        enderecos.forEach((endFazenda) => {
          select_fazenda.innerHTML += `<option value='${endFazenda.idEndereco}'>${endFazenda.nomeFazenda}</option>`;
        })
      })
    })



  function Pesquisar() {
    div_titulo_grafico.innerHTML = ''
    var fazendaVar = select_fazenda.value;
    var curralVar = listaCurrais.value;


    fetch("/sensores/mostrar/", {
      method: "POST",
      headers: {
        "Content-Type": "application/json"
      },
      body: JSON.stringify({
        fazendaServer: fazendaVar,
        curralServer: curralVar
      })
    })
      .then(resposta => resposta.json())
      .then(valor => {

        for (var i = 0; i < valor.length; i++) {
          
          var divPrincipal = document.getElementById('div_titulo_grafico');
          if (Sensores) {
            var div = document.createElement('div');
            var h4 = document.createElement('h4');
            var button1 = document.createElement('button');

            button1.classList.add('button_sensor');
            div.classList.add('div_tipos_metricas');

            div.innerHTML = valor.map(item => item.idSensor);

            h4 = valor.map(item => item.nomeSensor);

            div.innerHTML += h4[i];

            divPrincipal.appendChild(div);

            // div.appendChild(button1);

            div.innerHTML += `<button class='button_sensor' onclick=obterDadosGrafico(${i + 1})></button`
            console.log(i)

            fetch(`/medidas/ultimas/${i}`, { cache: 'no-store' }).then(function Teste(response) {
              if (response.ok) {
                response.json().then(function (resposta) {
                  console.log(`Dados recebidos: ${JSON.stringify(resposta)}`);
                  resposta.reverse();

                  var temperatura = resposta.map(item => Number(item.temperatura));
                  var umidade = resposta.map(item => Number(item.umidade));
                  console.log(resposta)
                  var buttons = document.getElementsByClassName('button_sensor');

                  for (var b = 0; b < buttons.length; b++) {
                    var currentButton = buttons[b];
                    var estiloButton = window.getComputedStyle(currentButton);
                    var cor = estiloButton.backgroundColor;

                    var medidaTemp = temperatura[b];
                    var medidaUmi = umidade[b];

                    console.log(medidaTemp)
                    console.log(medidaUmi)

                    if (medidaTemp > 24) {
                      currentButton.style.backgroundColor = 'red';
                    } else if (medidaTemp == 24) {
                      currentButton.style.backgroundColor = 'yellow';
                    } else if (medidaTemp < 24) {
                      currentButton.style.backgroundColor = 'green';
                    }

                    // if (medidaUmi >= 40 && medidaUmi <= 60) {
                    //   currentButton.style.backgroundColor = 'green';
                    // } else if ((medidaUmi > 60 && medidaUmi <= 65)) {
                    //   currentButton.style.backgroundColor = 'yellow';
                    // } else if (medidaUmi > 60 || medidaUmi < 40) {
                    //   currentButton.style.backgroundColor = 'red';
                    // }

                    console.log(medidaTemp);
                    console.log(medidaUmi)
                  }

                });
              } else {
                console.error('Nenhum dado encontrado ou erro na API');
              }
            })
              .catch(function (error) {
                console.error(`Erro na obtenção dos dados p/ gráfico: ${error.message}`);
              });

          } else {
            console.log('Impossível achar os dados');
          }
        }
      })
      .catch(erro => console.error(erro));

    return false;
  }
  setInterval(Pesquisar(), 3000);

  var sensores = JSON.parse(sessionStorage.SENSOR)
  console.log(sensores)
  let proximaAtualizacao;


  // O gráfico é construído com três funções:
  // 1. obterDadosGrafico -> Traz dados do Banco de Dados para montar o gráfico da primeira vez
  // 2. plotarGrafico -> Monta o gráfico com os dados trazidos e exibe em tela
  // 3. atualizarGrafico -> Atualiza o gráfico, trazendo novamente dados do Banco

  // Esta função *obterDadosGrafico* busca os últimos dados inseridos em tabela de medidas.
  // para, quando carregar o gráfico da primeira vez, já trazer com vários dados.
  // A função *obterDadosGrafico* também invoca a função *plotarGrafico*

  //     Se quiser alterar a busca, ajuste as regras de negócio em src/controllers
  //     Para ajustar o "select", ajuste o comando sql em src/models


  function obterDadosGrafico(fkSensor) {

    if (proximaAtualizacao != undefined) {
      clearTimeout(proximaAtualizacao);
    }

    fetch(`/medidas/ultimas/${fkSensor}`, { cache: "no-store" })
      .then(function (response) {
        if (response.ok) {
          response.json().then(function (resposta) {
            console.log(`Dados recebidos: ${JSON.stringify(resposta)}`);
            resposta.reverse();

            plotarGrafico(resposta, fkSensor);
          });
        } else {
          console.error("Nenhum dado encontrado ou erro na API");
        }
      })
      .catch(function (error) {
        console.error(
          `Erro na obtenção dos dados p/ gráfico: ${error.message}`
        );
      });

    fetch(`/medidas/tempo-real/${fkSensor}`, { cache: "no-store" })
      .then(function (response) {
        if (response.ok) {
          response.json().then(function (resposta) {
            console.log(`Dados recebidos: ${JSON.stringify(resposta)}`);
            resposta.reverse();

            plotarGrafico2(resposta, fkSensor);
          });
        } else {
          console.error("Nenhum dado encontrado ou erro na API");
        }
      })
      .catch(function (error) {
        console.error(
          `Erro na obtenção dos dados p/ gráfico: ${error.message}`
        );
      });

    fetch(`/medidas/mensal/${fkSensor}`, { cache: "no-store" })
      .then(function (response) {
        if (response.ok) {
          response.json().then(function (resposta) {
            console.log(`Dados recebidos: ${JSON.stringify(resposta)}`);
            resposta.reverse();

            plotarGrafico3(resposta, fkSensor);
            plotarGrafico4(resposta, fkSensor);
          });
        } else {
          console.error("Nenhum dado encontrado ou erro na API");
        }
      })
      .catch(function (error) {
        console.error(
          `Erro na obtenção dos dados p/ gráfico: ${error.message}`
        );
      });
  }
  // Esta função *plotarGrafico* usa os dados capturados na função anterior para criar o gráfico
  // Configura o gráfico (cores, tipo, etc), materializa-o na página e,
  // A função *plotarGrafico* também invoca a função *atualizarGrafico*
  function plotarGrafico(resposta, fkSensor) {
    console.log("iniciando plotagem do gráfico...");

    // Criando estrutura para plotar gráfico - labels
    let labels = [];

    // Criando estrutura para plotar gráfico - dados
    let dados = {
      labels: labels,
      datasets: [
        {
          label: "Umidade",
          data: [],
          fill: false,
          borderColor: "rgb(75, 192, 192)",
          tension: 0.1,
        },
      ],
    };

    console.log("----------------------------------------------");
    console.log(
      'Estes dados foram recebidos pela funcao "obterDadosGrafico" e passados para "plotarGrafico":'
    );
    console.log(resposta);

    // Inserindo valores recebidos em estrutura para plotar o gráfico
    for (i = 0; i < resposta.length; i++) {
      var registro = resposta[i];
      labels.push(registro.momento_grafico);
      dados.datasets[0].data.push(registro.umidade);
      // dados.datasets[0].data.push(registro.temperatura);
    }
    console.log("----------------------------------------------");
    console.log("O gráfico será plotado com os respectivos valores:");
    console.log("Labels:");
    console.log(labels);
    console.log("Dados:");
    console.log(dados.datasets);
    console.log("----------------------------------------------");

    // Criando estrutura para plotar gráfico - config
    const config = {
      type: "line",
      data: dados,
    };

    // Adicionando gráfico criado em div na tela
    let myChart = new Chart(
      document.getElementById(`dht11Umidade`),
      config
    );

    setTimeout(() => atualizarGrafico(fkSensor, dados, myChart), 2000);
  }


  function plotarGrafico2(resposta, fkSensor) {
    console.log("iniciando plotagem do gráfico...");

    // Criando estrutura para plotar gráfico - labels
    let labels = [];

    // Criando estrutura para plotar gráfico - dados
    let dados = {
      labels: labels,
      datasets: [
        {
          label: "Temperatura",
          data: [],
          fill: false,
          borderColor: "rgb(199, 52, 52)",
          tension: 0.1,
        },
      ],
    };

    console.log("----------------------------------------------");
    console.log(
      'Estes dados foram recebidos pela funcao "obterDadosGrafico" e passados para "plotarGrafico":'
    );
    console.log(resposta);

    // Inserindo valores recebidos em estrutura para plotar o gráfico
    for (i = 0; i < resposta.length; i++) {
      var registro = resposta[i];
      labels.push(registro.momento_grafico);
      // dados.datasets[0].data.push(registro.umidade);
      dados.datasets[0].data.push(registro.temperatura);
    }
    console.log("----------------------------------------------");
    console.log("O gráfico será plotado com os respectivos valores:");
    console.log("Labels:");
    console.log(labels);
    console.log("Dados:");
    console.log(dados.datasets);
    console.log("----------------------------------------------");

    // Criando estrutura para plotar gráfico - config
    const config = {
      type: "line",
      data: dados,
    };

    // Adicionando gráfico criado em div na tela
    let myChart = new Chart(
      document.getElementById(`lm35Temperatura`),
      config
    );

    setTimeout(() => atualizarGrafico2(fkSensor, dados, myChart), 2000);
  }

  function plotarGrafico3(resposta, fkSensor) {
    console.log("iniciando plotagem do gráfico...");

    // Criando estrutura para plotar gráfico - labels
    let labels = [];

    // Criando estrutura para plotar gráfico - dados
    let dados = {
      labels: labels,
      datasets: [
        {
          label: "Umidade mensal",
          data: [],
          fill: false,
          borderColor: "rgb(75, 192, 192)",
          tension: 0.1,
        },
      ],
    };

    console.log("----------------------------------------------");
    console.log(
      'Estes dados foram recebidos pela funcao "obterDadosGrafico" e passados para "plotarGrafico":'
    );
    console.log(resposta);

    // Inserindo valores recebidos em estrutura para plotar o gráfico
    for (i = 0; i < resposta.length; i++) {
      var registro = resposta[i];
      labels.push(registro.momento_grafico);
      dados.datasets[0].data.push(registro.umidade);
      // dados.datasets[0].data.push(registro.temperatura);
    }
    console.log("----------------------------------------------");
    console.log("O gráfico será plotado com os respectivos valores:");
    console.log("Labels:");
    console.log(labels);
    console.log("Dados:");
    console.log(dados.datasets);
    console.log("----------------------------------------------");

    // Criando estrutura para plotar gráfico - config
    const config = {
      type: "line",
      data: dados,
    };

    // Adicionando gráfico criado em div na tela
    let myChart = new Chart(
      document.getElementById(`dht11Umidade2`),
      config
    );

    setTimeout(() => atualizarGrafico3(fkSensor, dados, myChart), 2000);
  }

  function plotarGrafico4(resposta, fkSensor) {
    console.log("iniciando plotagem do gráfico...");

    // Criando estrutura para plotar gráfico - labels
    let labels = [];

    // Criando estrutura para plotar gráfico - dados
    let dados = {
      labels: labels,
      datasets: [
        {
          label: "Temperatura mensal",
          data: [],
          fill: false,
          borderColor: "rgb(199, 52, 52)",
          tension: 0.1,
        },
      ],
    };

    console.log("----------------------------------------------");
    console.log(
      'Estes dados foram recebidos pela funcao "obterDadosGrafico" e passados para "plotarGrafico":'
    );
    console.log(resposta);

    // Inserindo valores recebidos em estrutura para plotar o gráfico
    for (i = 0; i < resposta.length; i++) {
      var registro = resposta[i];
      labels.push(registro.momento_grafico);
      // dados.datasets[0].data.push(registro.umidade);
      dados.datasets[0].data.push(registro.temperatura);
    }
    console.log("----------------------------------------------");
    console.log("O gráfico será plotado com os respectivos valores:");
    console.log("Labels:");
    console.log(labels);
    console.log("Dados:");
    console.log(dados.datasets);
    console.log("----------------------------------------------");

    // Criando estrutura para plotar gráfico - config
    const config = {
      type: "line",
      data: dados,
    };

    // Adicionando gráfico criado em div na tela
    let myChart = new Chart(
      document.getElementById(`lm35Temperatura2`),
      config
    );

    setTimeout(() => atualizarGrafico3(fkSensor, dados, myChart), 2000);
  }


  // Esta função *atualizarGrafico* atualiza o gráfico que foi renderizado na página,
  // buscando a última medida inserida em tabela contendo as capturas,

  //     Se quiser alterar a busca, ajuste as regras de negócio em src/controllers
  //     Para ajustar o "select", ajuste o comando sql em src/models
  function atualizarGrafico(fkSensor, dados, myChart) {
    fetch(`/medidas/ultimas/${fkSensor}`, { cache: "no-store" })
      .then(function (response) {
        if (response.ok) {
          response.json().then(function (novoRegistro) {
            obterdados(fkSensor);
            // alertar(novoRegistro, fkSensor);
            console.log(`Dados recebidos: ${JSON.stringify(novoRegistro)}`);
            console.log(`Dados atuais do gráfico:`);
            console.log(dados);

            let avisoCaptura = document.getElementById(
              `avisoCaptura${fkSensor}`
            );
            avisoCaptura.innerHTML = "";

            if (
              novoRegistro[0].momento_grafico ==
              dados.labels[dados.labels.length - 1]
            ) {
              console.log(
                "---------------------------------------------------------------"
              );
              console.log(
                "Como não há dados novos para captura, o gráfico não atualizará."
              );
              avisoCaptura.innerHTML =
                "<i class='fa-solid fa-triangle-exclamation'></i> Foi trazido o dado mais atual capturado pelo sensor. <br> Como não há dados novos a exibir, o gráfico não atualizará.";
              console.log("Horário do novo dado capturado:");
              console.log(novoRegistro[0].momento_grafico);
              console.log("Horário do último dado capturado:");
              console.log(dados.labels[dados.labels.length - 1]);
              console.log(
                "---------------------------------------------------------------"
              );
            }
            // else {
            //   // tirando e colocando valores no gráfico
            //   dados.labels.shift(); // apagar o primeiro
            //   dados.labels.push(novoRegistro[0].momento_grafico); // incluir um novo momento

            //   dados.datasets[0].data.shift(); // apagar o primeiro de umidade
            //   dados.datasets[0].data.push(novoRegistro[0].umidade); // incluir uma nova medida de umidade

            //   dados.datasets[1].data.shift(); // apagar o primeiro de temperatura
            //   dados.datasets[1].data.push(novoRegistro[0].temperatura); // incluir uma nova medida de temperatura

            //   myChart.update();
            // }

            // Altere aqui o valor em ms se quiser que o gráfico atualize mais rápido ou mais devagar
            proximaAtualizacao = setTimeout(
              () => atualizarGrafico(fkSensor, dados, myChart),
              2000
            );
          });
        } else {
          console.error("Nenhum dado encontrado ou erro na API");
          // Altere aqui o valor em ms se quiser que o gráfico atualize mais rápido ou mais devagar
          proximaAtualizacao = setTimeout(
            () => atualizarGrafico(fkSensor, dados, myChart),
            2000
          );
        }
      })
      .catch(function (error) {
        console.error(
          `Erro na obtenção dos dados p/ gráfico: ${error.message}`
        );
      });
  }

  function atualizarGrafico2(fkSensor, dados, myChart) {
    fetch(`/medidas/tempo-real/${fkSensor}`, { cache: "no-store" })
      .then(function (response) {
        if (response.ok) {
          response.json().then(function (novoRegistro) {
            obterdados(fkSensor);
            // alertar(novoRegistro, fkSensor);
            console.log(`Dados recebidos: ${JSON.stringify(novoRegistro)}`);
            console.log(`Dados atuais do gráfico:`);
            console.log(dados);

            let avisoCaptura = document.getElementById(
              `avisoCaptura${fkSensor}`
            );
            avisoCaptura.innerHTML = "";

            if (
              novoRegistro[0].momento_grafico ==
              dados.labels[dados.labels.length - 1]
            ) {
              console.log(
                "---------------------------------------------------------------"
              );
              console.log(
                "Como não há dados novos para captura, o gráfico não atualizará."
              );
              avisoCaptura.innerHTML =
                "<i class='fa-solid fa-triangle-exclamation'></i> Foi trazido o dado mais atual capturado pelo sensor. <br> Como não há dados novos a exibir, o gráfico não atualizará.";
              console.log("Horário do novo dado capturado:");
              console.log(novoRegistro[0].momento_grafico);
              console.log("Horário do último dado capturado:");
              console.log(dados.labels[dados.labels.length - 1]);
              console.log(
                "---------------------------------------------------------------"
              );
            }
            // else {
            //   // tirando e colocando valores no gráfico
            //   dados.labels.shift(); // apagar o primeiro
            //   dados.labels.push(novoRegistro[0].momento_grafico); // incluir um novo momento

            //   dados.datasets[0].data.shift(); // apagar o primeiro de umidade
            //   dados.datasets[0].data.push(novoRegistro[0].umidade); // incluir uma nova medida de umidade

            //   dados.datasets[1].data.shift(); // apagar o primeiro de temperatura
            //   dados.datasets[1].data.push(novoRegistro[0].temperatura); // incluir uma nova medida de temperatura

            //   myChart.update();
            // }

            // Altere aqui o valor em ms se quiser que o gráfico atualize mais rápido ou mais devagar
            proximaAtualizacao = setTimeout(
              () => atualizarGrafico2(fkSensor, dados, myChart),
              2000
            );
          });
        } else {
          console.error("Nenhum dado encontrado ou erro na API");
          // Altere aqui o valor em ms se quiser que o gráfico atualize mais rápido ou mais devagar
          proximaAtualizacao = setTimeout(
            () => atualizarGrafico2(fkSensor, dados, myChart),
            2000
          );
        }
      })
      .catch(function (error) {
        console.error(
          `Erro na obtenção dos dados p/ gráfico: ${error.message}`
        );
      });
  }

  function atualizarGrafico3(fkSensor, dados, myChart) {
    fetch(`/medidas/mensal/${fkSensor}`, { cache: "no-store" })
      .then(function (response) {
        if (response.ok) {
          response.json().then(function (novoRegistro) {
            obterdados(fkSensor);
            // alertar(novoRegistro, fkSensor);
            console.log(`Dados recebidos: ${JSON.stringify(novoRegistro)}`);
            console.log(`Dados atuais do gráfico:`);
            console.log(dados);

            let avisoCaptura = document.getElementById(
              `avisoCaptura${fkSensor}`
            );
            avisoCaptura.innerHTML = "";

            if (
              novoRegistro[0].momento_grafico ==
              dados.labels[dados.labels.length - 1]
            ) {
              console.log(
                "---------------------------------------------------------------"
              );
              console.log(
                "Como não há dados novos para captura, o gráfico não atualizará."
              );
              avisoCaptura.innerHTML =
                "<i class='fa-solid fa-triangle-exclamation'></i> Foi trazido o dado mais atual capturado pelo sensor. <br> Como não há dados novos a exibir, o gráfico não atualizará.";
              console.log("Horário do novo dado capturado:");
              console.log(novoRegistro[0].momento_grafico);
              console.log("Horário do último dado capturado:");
              console.log(dados.labels[dados.labels.length - 1]);
              console.log(
                "---------------------------------------------------------------"
              );
            }
            // else {
            //   // tirando e colocando valores no gráfico
            //   dados.labels.shift(); // apagar o primeiro
            //   dados.labels.push(novoRegistro[0].momento_grafico); // incluir um novo momento

            //   dados.datasets[0].data.shift(); // apagar o primeiro de umidade
            //   dados.datasets[0].data.push(novoRegistro[0].umidade); // incluir uma nova medida de umidade

            //   dados.datasets[1].data.shift(); // apagar o primeiro de temperatura
            //   dados.datasets[1].data.push(novoRegistro[0].temperatura); // incluir uma nova medida de temperatura

            //   myChart.update();
            // }

            // Altere aqui o valor em ms se quiser que o gráfico atualize mais rápido ou mais devagar
            proximaAtualizacao = setTimeout(
              () => atualizarGrafico3(fkSensor, dados, myChart),
              2000
            );
          });
        } else {
          console.error("Nenhum dado encontrado ou erro na API");
          // Altere aqui o valor em ms se quiser que o gráfico atualize mais rápido ou mais devagar
          proximaAtualizacao = setTimeout(
            () => atualizarGrafico3(fkSensor, dados, myChart),
            2000
          );
        }
      })
      .catch(function (error) {
        console.error(
          `Erro na obtenção dos dados p/ gráfico: ${error.message}`
        );
      });
  }

  // var contextoDht11Umidade = document.getElementById('dht11Umidade').getContext('2d');
  // contextoDht11Umidade.canvas.width = 1000;
  // contextoDht11Umidade.canvas.height = 300;
  // var dht11Umidade = new Chart(
  //   contextoDht11Umidade,
  //   {
  //     type: 'line',
  //     data: {
  //       datasets: [{
  //         label: 'Umidade',
  //         type: 'line',
  //         data: [40, 50, 70],
  //         borderColor: ['#45b3e7'],
  //         backgroundColor: ['#89cff0']
  //       }]
  //     },
  //     options: {
  //       scales: {
  //         xAxes: [{
  //           distribution: 'series',
  //           ticks: {
  //             beginAtZero: true
  //           }
  //         }],
  //         yAxes: [{
  //           scaleLabel: {
  //             display: true,
  //             labelString: 'Umidade'
  //           },
  //           ticks: {
  //             beginAtZero: true
  //           }
  //         }]
  //       },
  //       animation: {
  //         duration: 0
  //       }
  //     }
  //   }
  // );


  // /* -- lm35Temperatura */
  // var contextoLm35Temperatura = document.getElementById('lm35Temperatura').getContext('2d');
  // contextoLm35Temperatura.canvas.width = 1000;
  // contextoLm35Temperatura.canvas.height = 300;
  // var lm35Temperatura = new Chart(
  //   contextoLm35Temperatura,
  //   {
  //     type: 'line',
  //     data: {
  //       datasets: [{
  //         label: 'Temperatura',
  //         type: 'line',
  //         data: [5, 10, 20, 24],
  //         borderColor: ['#d1196c'],
  //         backgroundColor: ['#ff0274']
  //       }]
  //     },
  //     options: {
  //       scales: {
  //         xAxes: [{
  //           distribution: 'series',
  //           ticks: {
  //             beginAtZero: true
  //           }
  //         }],
  //         yAxes: [{
  //           scaleLabel: {
  //             display: true,
  //             labelString: 'Temperatura'
  //           },
  //           ticks: {
  //             beginAtZero: true
  //           }
  //         }]
  //       },
  //       animation: {
  //         duration: 0
  //       }
  //     }
  //   }
  // );

  // var paginacao = {};
  // var tempo = {};
  // function obterDados(grafico, endpoint) {
  //   var http = new XMLHttpRequest();
  //   http.open('GET', 'http://localhost:3000/sensores/' + endpoint, false);
  //   http.send(null);
  //   var valores = JSON.parse(http.responseText);
  //   if (paginacao[endpoint] == null) {
  //     paginacao[endpoint] = 0;
  //   }
  //   if (tempo[endpoint] == null) {
  //     tempo[endpoint] = 0;
  //   }
  //   // Exibir à partir do último elemento exibido anteriormente
  //   var ultimaPaginacao = paginacao[endpoint];
  //   paginacao[endpoint] = valores.length;
  //   var valores = valores.slice(ultimaPaginacao);
  //   valores.forEach((valor) => {
  //     //Máximo de 60 itens exibidos no gráfico
  //     if (grafico.data.labels.length == 10 && grafico.data.datasets[0].data.length == 10) {
  //       grafico.data.labels.shift();
  //       grafico.data.datasets[0].data.shift();
  //     }

  //     grafico.data.labels.push(tempo[endpoint]++);
  //     grafico.data.datasets[0].data.push(parseFloat(valor));
  //     grafico.update();
  //   })
  // }

  // // setInterval(() => {
  // //    obterDados(dht11Umidade, 'dht11/umidade');
  // //    /* obterDados(dht11Temperatura, 'dht11/temperatura'); */
  // //    /* obterDados(luminosidade, 'luminosidade'); */
  // //    obterDados(lm35Temperatura, 'lm35/temperatura');
  // //    /* obterDados(chave, 'chave'); */
  // //  }, 1000);

  // var abrir = (async () => {
  //   obterDados(dht11Umidade, 'dht11/umidade');
  //   /* obterDados(dht11Temperatura, 'dht11/temperatura'); */
  //   /* obterDados(luminosidade, 'luminosidade'); */
  //   obterDados(lm35Temperatura, 'lm35/temperatura');
  //   /* obterDados(chave, 'chave'); */
  // }, 1000);
  //   obterDados(dht11Umidade, 'dht11/umidade');
  //   /* obterDados(dht11Temperatura, 'dht11/temperatura'); */
  //   /* obterDados(luminosidade, 'luminosidade'); */
  //   obterDados(lm35Temperatura, 'lm35/temperatura');
  //   /* obterDados(chave, 'chave'); */
  // }, 4000);


</script>
<style>
  * {
    padding: 0;
    margin: 0;
    font-family: Poppins;
  }

  .button_sensor {
    padding: 2%;
    width: 90%;
    height: 25px;
    border: 1px solid black;
    margin-top: 60%;
    border-radius: 10px;
    cursor: pointer;
    box-shadow: 7px 6px 15px -6px rgba(0, 0, 0, 0.75);
    -webkit-box-shadow: 6px 5px 10px -6px rgba(0, 0, 0, 0.75);
    -moz-box-shadow: 7px 6px 15px -6px rgba(0, 0, 0, 0.75);

  }

  .button_sensor:hover {
    padding: 2%;
    width: 90%;
    height: 25px;
    border: 1px solid black;
    margin-top: 60%;
    border-radius: 10px;
    opacity: 0.8;
  }

  .button_sensor:focus {
    background-color: black;
    border: 0;
  }

  canvas {
    -moz-user-select: none;
    -webkit-user-select: none;
    -ms-user-select: none;
  }

  .principal_pagina_grafico {
    background-color: white;
  }

  .cabecario {
    display: flex;
    width: 100%;
    height: fit-content;
    flex-direction: row;
    background-color: transparent;
    padding: 20px 0 0 0;
  }

  #div_logo {
    padding: 10px;
    width: 40%;
  }

  #texto_cowtech {
    margin: 0 0 0 5%;
    font-weight: 600;
    font-size: 25px;
  }

  #texto_cowtech a {
    text-decoration: none;
    list-style: none;
    color: black;
    margin: 0 0 0 5%;
    font-weight: 600;
    font-size: 25px;
  }

  #div_links {
    display: flex;
    flex-direction: row;
    width: 5%;
    width: 60%;
    padding: 10px;
    text-align: center;
  }

  #lista_cabecario {
    justify-content: right;
    text-align: right;
    display: flex;
    flex-direction: row;
    width: 100%;
  }

  #lista_cabecario a {
    text-decoration: none;
    color: black;
    list-style: none;
    margin: 8px 10% 0 0;
    font-weight: 500;
    font-size: 17px;
  }

  #lista_cabecario a:hover {
    opacity: 0.8;
  }

  #texto_cowtech a:hover {
    opacity: 0.8;
  }

  #div_graficos {
    display: flex;
    align-items: center;
    justify-content: center;
    width: 100%;
    height: fit-content;
    flex-direction: column;
  }

  #div_procurar {
    margin-top: 5%;
    width: 80%;
    padding: 1%;
    display: flex;
    align-items: center;
    justify-content: center;
  }

  #inpu_search {
    width: 60%;
    padding: 0.5%;
    border-radius: 3px;
    border: 0.8px solid black;
    box-shadow: -1px 4px 10px -6px rgba(0, 0, 0, 0.75);
    -webkit-box-shadow: -1px 4px 10px -6px rgba(0, 0, 0, 0.75);
    -moz-box-shadow: -1px 4px 10px -6px rgba(0, 0, 0, 0.75);
  }

  #button_lupa {
    background-color: transparent;
    border: 0;
    position: absolute;
    margin-left: 44%;
    height: 16px;
    width: 16px;
    margin-bottom: 1%;
  }

  #div_titulo_grafico {
    margin-top: 2%;
    width: 80%;
    display: flex;
    flex-direction: row;
    overflow-x: scroll;
    overflow-y: hidden;
    align-items: center;
    /* Mantenha o overflow-y como hidden para esconder a barra de rolagem vertical */
    justify-content: center;
    white-space: nowrap;
  }

  #div_titulo_grafico::-webkit-scrollbar {
    width: 100%;
    height: 10px;
  }

  #div_titulo_grafico::-webkit-scrollbar-thumb {
    background: #888;
    border-radius: 6px;
  }

  #div_titulo_grafico::-webkit-scrollbar-thumb:hover {
    background: #555;
  }

  #div_titulo_grafico::-webkit-scrollbar-track {
    background: #f1f1f1;
    border-radius: 6px;
  }


  .div_tipos_metricas {
    width: 15%;
    border-radius: 5px;
    margin: 2%;
    height: 170px;
    padding: 2%;
    border: 1px solid black;
    display: flex;
    align-items: center;
    flex-direction: column;
  }

  #div_todos_graficos {
    width: 100%;
    margin-top: 2%;
    height: fit-content;
    display: flex;
    flex-direction: column;
    margin-bottom: 5%;
  }

  #div_separacao_grafico {
    width: 100%;
    display: flex;
    justify-content: center;
  }

  .graficos1 {
    margin-top: 1%;
    border-radius: 10px;
    width: 40%;
    display: flex;
    border: 1px solid black;
    height: 350px;
    box-shadow: 7px 6px 15px -6px rgba(0, 0, 0, 0.75);
    -webkit-box-shadow: 7px 6px 15px -6px rgba(0, 0, 0, 0.75);
    -moz-box-shadow: 7px 6px 15px -6px rgba(0, 0, 0, 0.75);
  }

  .buttonMetrica {
    width: 100%;
    height: 20px;
    margin-top: 50%;
  }

  #div_select {
    width: 80%;
    padding: 2%;
    margin-top: 7%;
    display: flex;
    justify-content: center;
    flex-direction: row;
    align-items: center;
  }

  #div_select h4 {
    position: absolute;
    top: 20%;
  }

  #select_galpao {
    right: 60%;
  }

  #select_fazenda_h4 {
    right: 35%;
  }

  #button_pesquisar {
    background-color: transparent;
    border: none;
    max-width: 20px;
  }

  #button_pesquisar:hover {
    cursor: pointer;
  }

  .select_grafico {
    width: 30%;
    padding: 0.3%;
    margin-right: 2%;
    border-radius: 5px;

  }

  .button_informacao_grafico {
    width: 100%;
    height: 100%;
    background-color: transparent;
    border: 0;
    cursor: pointer;
    opacity: 0.8;
  }
</style>

</html>